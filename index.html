<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
  <head>
    <title>Jenkins job template for Drupal projects</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="http://kevinburke.bitbucket.org/markdowncss/markdown.css" rel="stylesheet"></link>
    <link href="styles/styles.css" rel="stylesheet"></link>
  </head>
  <body>
    <h1>Jenkins job template for Drupal projects</h1>
    <blockquote>
  <p>Most web applications are changed and adapted quite frequently and quickly. Their environment, for example the size and the behaviour of the user base, are constantly changing. What was sufficient yesterday can be insufficient today. Especially in a web environment it is important to monitor and continuously improve the internal quality not only when developing, but also when maintaining the software.</p>
  
  <p><a href="http://jenkins-ci.org">Jenkins</a> is the leading <a href="http://en.wikipedia.org/wiki/Open_Source">open-source</a> <a href="http://martinfowler.com/articles/continuousIntegration.html">continuous integration</a> server. Thanks to its thriving plugin ecosystem, it supports building and testing virtually any project.</p>
  
  <p><cite>Sebastian Bergmann and contributors, <a href="http://jenkins-php.org/">Template for Jenkins Jobs for PHP Projects</a></cite></p>
</blockquote>

<p>The goals of the Jenkins job template for PHP projects also holds true for <a href="http://drupal.org">Drupal</a> projects. However Drupal has it's own idiosyncrasies so <a href="#differences-from-php-template">tools and metrics differ</a>.</p>

<p>This project aims to provide a standard Jenkins job template for Drupal projects.</p>

<p>Along with the <a href="http://reload.github.com/phing-drupal-template">Phing Drupal Template</a> and the <a href="http://github.com/kasperg/drupal-jenkins-demo">Drupal Jenkins demo</a> it is a part of an effort to create better continuous integration tools for Drupal projects to improve quality.</p>

<h2>Required Jenkins Plugins</h2>

<p>You need to install the following plugins for Jenkins:</p>

<ul>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Analysis+Collector+Plugin">Analysis Collector</a> (for processing various logfiles)</li>
<li><a href="http://wiki.jenkins-ci.org/display/JENKINS/Checkstyle+Plugin">Checkstyle</a> (for processing <a href="http://drupal.org/project/coder">Drupal Coder module</a> or <a href="http://pear.php.net/PHP_CodeSniffer">PHP_Codesniffer</a> logfiles in Checkstyle format)</li>
<li><a href="http://wiki.jenkins-ci.org/display/JENKINS/DRY+Plugin">DRY</a> (for processing <a href="https://github.com/sebastianbergmann/phpcpd">phpcpd</a> logfiles in PMD-CPD format)</li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Phing+Plugin">Phing</a> (for running <a href="http://phing.info">Phing</a> build files)</li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Plot+Plugin">Plot</a> (for processing <a href="https://github.com/sebastianbergmann/phploc">phploc</a> CSV output)</li>
<li><a href="http://wiki.jenkins-ci.org/display/JENKINS/PMD+Plugin">PMD</a> (for processing <a href="http://phpmd.org/">PHPMD</a> logfiles in PMD format)</li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Static+Code+Analysis+Plug-ins">Static Code Analysis</a> (for processing various logfiles)</li>
</ul>

<p>You can install these plugins using the web frontend at</p>

<pre><code>http://localhost:8080/pluginManager/available
</code></pre>

<p>or using the <a href="http://wiki.jenkins-ci.org/display/JENKINS/Jenkins+CLI">Jenkins CLI</a>:</p>

<pre><code>wget http://localhost:8080/jnlpJars/jenkins-cli.jar
java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin analysis-core
java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin analysis-collector
java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin checkstyle
java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin dry
java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin phing
java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin plot
java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin pmd
java -jar jenkins-cli.jar -s http://localhost:8080 safe-restart
</code></pre>

<p>In the above, replace <code>localhost:8080</code> with the hostname and port of your Jenkins installation.</p>

<h2>Build Automation</h2>

<p>The configuration of the job template follows the artifacts produced by a <a href="http://www.phing.info/trac/">Phing</a> build.xml file based on the <a href="http://reload.github.com/phing-drupal-template">Phing Drupal Template</a>.</p>

<p>The template assumes that the build template has been added as a submodule in <code>\build</code> as described in the <a href="http://reload.github.com/phing-drupal-template">Phing Drupal template documentation</a>.</p>

<h2>Using the Job Template</h2>

<ol>
<li>Check out the <code>jenkins-drupal-template</code> project from Git:
<pre><code>cd $JENKINS_HOME/jobs
git clone git://github.com/reload/jenkins-drupal-template.git drupal-template
chown -R jenkins:nogroup drupal-template/</code></pre></li>
<li>Reload Jenkins' configuration, for instance using the Jenkins CLI:
<pre><code>java -jar jenkins-cli.jar -s http://localhost:8080 reload-configuration</pre></code></li>
<li>Click on <em>New Job</em>.</li>
<li>Enter a <em>Job name</em>.</li>
<li>Select <em>Copy existing job</em> and enter <em>drupal-template</em> into the <em>Copy from</em> field.</li>
<li>Click <em>OK</em>.</li>
<li>Disable the <em>Disable Build</em> option.</li>
<li>Fill in your <em>Source Code Management</em> information.</li>
<li>Configure a <em>Build Trigger</em>, for instance <em>Poll SCM</em>.</li>
<li>Click <em>Save</em>.</li>
</ol>

<h2>Demo</h2>

<p>The <a href="http://github.com/kasperg/drupal-jenkins-demo">drupal-jenkins-demo repository</a> contains a Drupal project with the <a href="http://reload.github.com/phing-drupal-template">Phing Drupal Template</a> and the <a href="http://drupal.org/project/token">Token module</a> as example of custom code is continuously integrated for <a href="http://jenkins.kasper.reload.dk:8080/job/drupal-demo/">demonstration</a> purposes.</p>

<h2><span id="differences-from-php-template">Differences from PHP Template</span></h2>

<p>The job template has a number of differences from the original <a href="http://jenkins-php.org">Template for Jenkins Jobs for PHP Projects</a>. Some of these are due to Drupal tools and practices and others personal preference.</p>

<h3>Build file in separate project</h3>

<p>Due to the extensive work required to setup an automated build for Drupal projects the build file has been split into <a href="http://reload.github.com/phing-drupal-template">a separate project</a>. This also makes the build file useful with other continuous integration systems.</p>

<h3>JDepend plugin removed</h3>

<p><a href="http://pdepend.org/documentation/software-metrics.html">The metrics calculated by PHP_Depend</a> and displayed by the <a href="https://wiki.jenkins-ci.org/display/JENKINS/JDepend+Plugin">JDepend plugin</a> are mostly related for object oriented programming. Most Drupal modules written using functional programming and thus the metrics are at best of little value, at worst misleading.</p>

<h3>xUnit plugin removed</h3>

<p>Drupal tests are run through the <a href="http://drupal.org/simpletest">SimpleTest framework</a>. SimpleTest results can be written in JUnit XML format using <a href="http://drupalcode.org/project/drupal.git/blob/refs/heads/7.x:/scripts/run-tests.sh#l145">Drupal scripts</a> or <a href="http://drush.ws/help/5#test-run">Drush</a> and Jenkins understands this format natively so there is no need for the plugin.</p>

<h3>Static Code Analysis plugins replaces Violations</h3>

<p>The <a href="https://wiki.jenkins-ci.org/display/JENKINS/Static+Code+Analysis+Plug-ins">Static Code Analysis plugins suite</a> and <a href="https://wiki.jenkins-ci.org/display/JENKINS/Violations">Violations plugin</a> both support parsing and rendering static code analysis results. The Static Code Analysis plugins are used as they are have more features and are frequently updated.</p>

<h2>Support</h2>

<p><a href="https://github.com/reload/jenkins-drupal-template/issues">Issues are tracked on GitHub</a>. Comments and pull requests welcome.</p>


    <hr/>
    <div class="footer">
      <p>
        The <em>Jenkins job template for Drupal projects</em> is developed by <a href="http://reload.dk">Reload!</a> - a Drupal development agency located in Copenhagen, Denmark. It is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License.
      </p>
      <p>
        It is based upon Sebastian Bergmans <em><a href="http://jenkins-php.org/">Template for Jenkins Jobs for PHP Projects</a></em>.
      </p>

      <a href="http://github.com/reload/jenkins-drupal-template"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://a248.e.akamai.net/assets.github.com/img/7afbc8b248c68eb468279e8c17986ad46549fb71/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub"></a>
    </div>
  </body>
</html>
